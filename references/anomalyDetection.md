## Anomaly Detection 종류

1. **기계 학습 기반 방법**:
   - **지도 학습 (Supervised Learning)**: 정상적인 데이터와 비정상적인 데이터를 포함한 데이터셋을 사용하여 모델을 학습합니다. 주로 이상 탐지에 사용되는 클래스의 데이터가 제한적인 경우에 유용합니다.
   - **비지도 학습 (Unsupervised Learning)**: 정상적인 데이터만 있는 데이터셋에서 모델을 학습합니다. 이상치는 정상적인 데이터에서 벗어난 패턴으로 간주됩니다.
   - **준지도 학습 (Semi-Supervised Learning)**: 일부 데이터만 레이블이 지정되어 있는 경우 사용됩니다. 정상적인 데이터는 레이블이 지정되고, 이를 사용하여 모델을 학습한 후, 이상치를 식별합니다.
2. **통계 기반 방법**:
   - **확률적 이상 탐지 (Probabilistic Anomaly Detection)**: 데이터 분포의 확률 모델을 사용하여 이상치를 식별합니다.
   - **교차-기간 이상 탐지 (Seasonal Anomaly Detection)**: 데이터의 시간적 패턴을 고려하여 이상치를 식별합니다.
3. **신경망 기반 방법**:
   - **오토인코더 (Autoencoder)**: 입력 데이터를 잠재 공간으로 압축하고 재구성하는 신경망을 사용하여 이상을 감지합니다.
   - **GAN (Generative Adversarial Networks)**: 생성적 적대 신경망은 생성기와 판별자로 구성되어 있으며, 생성기는 정상적인 데이터를 생성하고, 판별자는 생성기가 생성한 데이터와 실제 데이터를 구별합니다. 생성기가 생성한 이상적인 샘플은 판별자에 의해 식별됩니다.
4. **기타 방법**:
   - **특이치 탐지 (Outlier Detection)**: 특이치 탐지는 전통적인 통계 기반 이상 탐지 방법 중 하나로, 데이터의 통계적 속성을 기반으로 이상치를 식별합니다.
   - **시계열 이상 탐지 (Time Series Anomaly Detection)**: 시계열 데이터에서 이상치를 식별하는 방법으로, 데이터의 트렌드, 계절성 및 주기성을 고려하여 이상을 감지합니다.

## 레퍼런스 1번

https://github.com/aws-samples/sound-anomaly-detection-for-manufacturing/blob/main/1_data_exploration.ipynb

위 오픈 소스는 비지도 학습 기반의 Anomaly Detection 방법임

위에서의 비지도 학습 방법 설명처럼 데이터셋에는 정상적인 데이터만 포함되어 있고, 이상치는 정상적인 데이터에서 벗어난 패턴으로 간주함

즉, 이상 탐지를 위해 레이블이 지정되어 있지 않은 데이터셋에서 모델을 학습함

특히, 오픈 소스에서는 Autoencoder로 이상을 감지함

참고로, Autoencoder는 입력 데이터를 잠재 공간으로 압축하고 재구성하는 신경망임

이상적인 경우에는 재구성 오차가 작을 것으로 기대됨

결론적으로, 이를 통해 이상적인 패턴과 다른 패턴을 감지할 수 있음

[GitHub - gefleury/datascientest_anomalous_sounds: Anomalous sound detection with machine learning and deep learning](https://github.com/gefleury/datascientest_anomalous_sounds?tab=readme-ov-file)

이것도 비지도 학습 기반 코드 예시

## 레퍼런스 2번

https://www.sciencedirect.com/science/article/pii/S1877050921015180/pdf?md5=5793fade77a86791b0201c20c0d37520&pid=1-s2.0-S1877050921015180-main.pdf

위 레퍼런스는 차량 내 오디오 이상 감지를 위한 딥 오토인코더 사용에 관한 논문임

주요 키워드로는 이상 감지, 오디오 입력 표현, 딥러닝, 차량 내 데이터, 비지도 학습임

우리에게 필요한 것은 이상 감지와 오디오 입력 표현, 비지도 학습인데 음 ..

이게 좀 우리랑 입장이 비슷한게 연구팀이 음성 데이터가 부족해서 실제 차량 운행 중 녹음된 배경 오디오와 일반적인 이벤트 및 비정상적인 이벤트 소리를 혼합하여 실제와 유사한 차량 내 음향 데이터 세트를 생성하는 시뮬레이터를 설계했음

쉽게 말해 찐으로 필요한 대화 소리와 노이즈인 기침 소리 등을 혼합해서 음성 데이터셋을 만들었다고 보면 됨

아무튼 LSTM 기반 오토인코더의 구조와 학습 방법의 설명이 포함되어 있고, 이는 차량 내에서 발생할 수 있는 이상 음향을 감지하는 데 중요한 역할을 한다는데 그러면 선박에서도 나름 비슷하지 않을까란 생각이 듦

## 레퍼런스 3번

[[Deep Learning 101] 오토인코더 Autoencoder를 소개합니다](https://youtu.be/T97B4h709m4?si=tXkVeDhaAC-L8JXx)

오토인코더 설명 영상인데, 나름 쉽게 알려주네

[Anomaly Detection in Industrial Equipment using Sound Signals](https://medium.com/@naveed88375/anomaly-detection-in-industrial-equipment-using-sound-signals-5d9a654795ea)

오토인코더 사용 예시

[[코드리뷰]LSTM-based Anomaly Detection - 새내기 코드 여행](https://joungheekim.github.io/2020/11/14/code-review/)

**LSTM-based Encoder-Decoder for Multi-sensor Anomaly Detection 코드 예시**

## 만약 비지도 학습 방법을 고려한다면 이점은 ?

1. **데이터 라벨링의 필요성 감소**: 비지도 학습 방식은 정상적인 데이터 패턴만을 학습하여 이상 상태를 식별할 수 있으므로, 라벨링된 데이터가 많지 않은 상황에서 유리합니다.
2. **리얼타임 이상 감지**: LSTM-AE (Long Short-Term Memory Autoencoder)와 같은 모델은 시간에 따른 데이터의 변화를 잘 포착할 수 있어, 실시간 데이터 스트림에서도 효과적으로 이상을 감지할 수 있습니다.
3. **복잡한 데이터 패턴 인식**: LSTM은 시계열 데이터에서 복잡한 패턴을 인식하는 능력이 뛰어나기 때문에, 네트워크 통신 데이터의 미묘한 이상을 감지하는 데 적합합니다.
4. **확장성**: 이 방법은 다양한 유형의 데이터와 다른 네트워크 시나리오로 확장이 가능합니다. 예를 들어, 다른 종류의 통신 데이터나 다양한 네트워크 조건에서도 적용할 수 있습니다.

## **적용 방법**

- **데이터 준비**: 네트워크를 통한 오디오 전송 전후의 데이터를 수집합니다.
- **특성 추출**: LSTM-AE를 사용하기 전에 필요한 오디오 특성 (예: 멜 주파수 켑스트럴 계수)을 추출합니다.
- **모델 학습**: 정상적인 통신 데이터로만 모델을 학습시켜 정상 패턴을 학습합니다.
- **이상 감지**: 학습된 모델을 사용하여 실시간 데이터 스트림에서 이상을 감지합니다. 이상 데이터는 높은 복원 오류를 가지게 됩니다.

## **구현 도구**

- **Python**: 프로그래밍 및 데이터 핸들링
- **TensorFlow, Keras, PyTorch**: 딥러닝 모델 구현
- **LibROSA**: 오디오 데이터 분석 및 특성 추출
- **Apache Kafka, Redis**: 실시간 데이터 스트림 처리

## 필요한 기술 스택

1. **오디오 신호 처리**:
   - 오디오 데이터의 특성을 이해하고, 적절한 특성을 추출할 수 있어야 합니다. 이를 위해 오디오 샘플링, 멜 주파수 켑스트럴 계수(MFCCs), 스펙트럼 분석 등의 기술이 필요합니다.
2. **머신 러닝 및 딥러닝**:
   - 비지도 학습 방식, 특히 오토인코더(Autoencoders), LSTM(Long Short-Term Memory) 네트워크와 같은 심층 신경망의 원리와 구현에 대한 이해가 필요합니다.
   - TensorFlow, Keras, PyTorch와 같은 딥러닝 프레임워크를 사용한 모델링 경험이 필요합니다.
3. **통계 및 데이터 분석**:
   - 데이터에서 유의미한 정보를 추출하고, 이상치를 식별하기 위한 통계적 방법을 이해하고 적용할 수 있어야 합니다.
   - Anomaly Detection에서 사용되는 다양한 알고리즘과 접근법을 숙지하고, 적절한 방법을 선택할 수 있어야 합니다.
4. **네트워크 통신**:
   - VoIP와 같은 네트워크 프로토콜과 IP 네트워크에서의 데이터 패킷 전송 방법을 이해해야 합니다.
   - 네트워크 지연, 패킷 손실, 지터 등의 네트워크 이슈와 그 원인을 이해할 수 있어야 합니다.
5. **실시간 데이터 처리**:
   - Apache Kafka, Redis와 같은 도구를 사용하여 대규모 실시간 데이터 스트림을 처리할 수 있는 능력이 필요합니다.
   - 데이터 스트리밍과 이벤트 처리에서 발생할 수 있는 문제들을 해결할 수 있어야 합니다.
6. **소프트웨어 개발**:
   - Python과 같은 프로그래밍 언어에 숙련되어 있어야 하며, API 개발, 시스템 통합, 데이터베이스 관리 등 소프트웨어 개발 전반에 걸친 지식이 필요합니다.

## 대충 우리 프로젝트에 빗대어 본 과정들

### **1. 데이터 준비 및 전처리**

- **녹음**: 노트북을 사용하여 음성을 녹음합니다. 이 때 주변 소음이나 불필요한 배경 소리도 함께 녹음될 수 있습니다.
- **디지털화**: 아날로그 오디오 신호를 디지털 형식으로 변환합니다. 이 과정에서 샘플링 레이트와 비트 해상도를 설정하여 오디오의 디지털 데이터를 생성합니다.
- **전처리**: 디지털화된 데이터는 필요에 따라 노이즈 제거, 정규화 등의 처리를 거칩니다. 이는 데이터를 모델에 적합한 형태로 만듭니다.

### **2. 특성 추출**

- **특성 추출**: 변환된 디지털 오디오 데이터에서 유용한 특성을 추출합니다. 멜 주파수 켑스트럴 계수(MFCCs)는 음성 인식에서 널리 사용되는 특성으로, 음성의 다양한 성질을 잘 나타냅니다.

### **3. 패킷화 및 네트워크 전송**

- **압축 및 패킷화**: 디지털 오디오 데이터를 압축하고 작은 패킷으로 분할하여 UDP 네트워크를 통해 전송합니다. 이 과정에서 데이터의 손실, 지연 또는 순서 문제가 발생할 수 있습니다.
- **수신 및 재조합**: 전송된 패킷들을 수신하여 원래의 오디오 데이터를 재구성합니다. 패킷의 손실이나 순서 문제 등이 발생하면 오디오의 품질에 영향을 줄 수 있습니다.

### **4. Anomaly Detection 모델 구성 및 훈련 (★)**

- **오토인코더 모델 구성**: 데이터의 정상 패턴을 학습할 수 있도록 오토인코더를 구성합니다. 오토인코더는 인코더와 디코더로 구성되며, 입력 데이터를 압축한 뒤 이를 재구성하여 원본과 비교합니다.
- **모델 훈련**: 정상적인 상태의 오디오 데이터만을 사용하여 오토인코더를 훈련합니다. 이를 통해 모델은 정상 오디오의 특성과 패턴을 학습합니다.

### **5. 이상 감지 실행 (★)**

- **재구성 오차 계산**: 훈련된 오토인코더를 사용하여 모든 수신된 오디오 데이터를 재구성하고, 입력 데이터와 재구성된 데이터 사이의 오차를 계산합니다.
- **이상 판정**: 재구성 오차가 사전에 설정된 임계값을 초과하면, 해당 데이터에는 문제가 있음을 나타내고 이상으로 판단합니다. 이는 녹음 과정에서의 배경 소음, 기계 소음, 통신 과정에서의 패킷 이슈 등이 원인일 수 있습니다.
